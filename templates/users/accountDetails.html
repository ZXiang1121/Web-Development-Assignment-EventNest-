{% extends "base.html" %}
{% block title %}EventNest - Log In{% endblock %}

{% block content %}

<!-- if user created alert -->
{% if 'user_created' in session %}
<div class="alert alert-success alert-dismissible fade show">
  {{ session.pop('user_created', None) }} was created.
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>


<!-- if user updated alert -->
{% elif 'user_updated' in session %}
<div class="alert alert-warning alert-dismissible">
  {{ session.pop('user_updated', None) }} was updated.
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>

<!-- if user log in -->
{% elif 'logged_in' in session %}
<div class="alert alert-success alert-dismissible">
  {{ session.pop('logged_in', None) }} has logged in.
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
{% endif %}

<div class="p-3 mb-2 bg-light pt-5">
    <div class="container-sm col-lg-6 ml-auto">
        
        <!-- Nav tabs -->
        <h3 class="row justify-content-center text-center"><i class="fa-solid fa-user-astronaut fa-4x"></i></i></h3>


        <br>
        <br>
        


        <ul class="nav nav-tabs nav-fill" id="pills-tab" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="pills-account-tab" data-bs-toggle="pill" data-bs-target="#pills-account" type="button" role="tab" aria-controls="pills-account" aria-selected="true">Account</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="pills-dashboard-tab" data-bs-toggle="pill" data-bs-target="#pills-dashboard" type="button" role="tab" aria-controls="pills-dashboard" aria-selected="false">Dashboard</button>
          </li>

        </ul>


        <div class="tab-content" id="pills-tabContent">
          <div class="tab-pane fade show active" id="pills-account" role="tabpanel" aria-labelledby="pills-account-tab">


              <br>
              <br>
                <table class="table table-borderless mx-auto pl-2" style="width: 50%;">
                    
                    <tbody>
                      
                      <tr>
                        <td scope="row">Name</td>
                        <td>{{ session['username'] }}</td>
                      </tr>
                      <tr>
                        <td scope="row">Email</td>
                        <td>{{ session['user_email'] }}</td>
                      </tr>
                      <tr>
                        <td scope="row">Birthday</td>
                        <td>{{ session['user_birthdate'] }}</td>
                      </tr>
                      
                    </tbody>
                  </table>
                  <br>

                <div class="row justify-content-center pt-3">
                    <div class="col">
                        <a href="/EditAcc/{{ session['user_id'] }}"><button type="button" class="btn btn-primary btn-md form-control btn-block">Edit details</button></a>
                    </div>
                    <div class="col">
                        <a href="/ChangePass/{{ session['user_id'] }}"><button type="button" class="btn btn-primary btn-md form-control btn-block">Change password</button></a>
                    </div>
                </div>

                <!-- <div class="row justify-content-center mt-3" > -->
                <div class="d-grid gap-2 col-6 mx-auto mt-3">
                  <a class="btn btn-outline-primary  display-inline-block" href="/logout" role="button" onclick="return confirm('Are you sure you want to log out?');">Log Out</a>
                </div>

          </div>
          

          <div class="tab-pane fade" id="pills-dashboard" role="tabpanel" aria-labelledby="pills-dashboard-tab">
            <div class="app">   
              <div class="app-wrapper">
                
                <div class="app-content pt-3 p-md-3">
                  <div class="container-xl">
                    
                    <h1 class="app-page-title">Overview</h1>
          
                  <div class="col-12 g-4 mb-4">
                    <div class="app-card app-card-chart h-100 shadow-sm">
                      <div class="app-card-header p-3">
                        <div class="row justify-content-between align-items-center">
                          <div class="col-auto">
                            <h4 class="app-card-title">Line Chart Example</h4>
                          </div><!--//col-->
                          <div class="col-auto">
                            <div class="card-header-action">
                              <div class="mb-2 d-flex">   
                                <select class="form-select form-select-sm ms-auto d-inline-flex w-auto">
                                  <option value="1" selected>This week</option>
                                  <option value="2">Today</option>
                                  <option value="3">This Month</option>
                                  <option value="3">This Year</option>
                                </select>
                              </div>
                            </div><!--//card-header-actions-->
                          </div><!--//col-->
                        </div><!--//row-->
                      </div><!--//app-card-header-->
                      <div class="app-card-body p-3 p-lg-4">
          
                        <div class="chart-container">
                          <canvas style="max-height:250px;" id="myChart"></canvas>
                          <input id="barval" onkeyup="updateChart(this)" type="number">
                          <script>
          
          const data = {
                labels: [{% for item in labels %} "{{item}}",{% endfor %}], 
                datasets: [{
                  label: '{{ legend }}',
                  data: [{% for item in values %} {{item}} ,{% endfor %}],
                  backgroundColor: [
                    'rgba(255, 26, 104, 0.2)',
                  ],
                  borderColor: [
                    'rgba(255, 26, 104, 1)',
                  ],
                  borderWidth: 3,
              pointRadius:3,
              yAxisID:'{{ legend }}'
                },
              {
                  label: 'Total Users',
                  data:  [{% for item in BarVal %} {{item}} ,{% endfor %}],
                  backgroundColor: [
              'rgb(0, 0, 255)',
                  ],
                  borderColor: [
                    'rgba(255, 26, 104, 1)',
                  ],
              type:'bar',
              yAxisID:'users'
                }
            ]
              };
          
              // config
              const config = {
                type: 'line',
                data,
              options: {
                 scales: {
              '{{ legend }}':{
              beginAtZero:true,
              type:'linear',
              position:'left',
              grid:{
                display:false
              }
              },
              users:{
              beginAtZero:true,
              type:'linear',
              position:'right',
              grid:{
                display:false
              }
              },
                 }
              }
          };
          
              // render init block
                const ctx = document.getElementById('myChart');
                const myChart = new Chart(
                ctx,
                config
              );
          
            function updateChart(barval) {
              console.log(barval.value)
              myChart.config.data.datasets[1].data[0] = barval.value;
              myChart.update()
            }
          
              </script>
                        </div>
                      </div><!--//app-card-body-->
                    </div><!--//app-card-->
                  </div><!--//col-->
                      
                    <div class="row g-3 mb-4">
                      <div class="col-12 col-sm-6 col-xl-4 mb-4">
                        <div class="app-card app-card-stat shadow-sm h-70">
                          <div class="app-card-body p-3 p-lg-4">
                            <h4 class="stats-type mb-1">Total Sales</h4>
                          <div class="chart-container">
                            <div id="gaugeArea"></div>
                          <script>
          // Element inside which you want to see the chart
          let element = document.querySelector('#gaugeArea')
          
          // Properties of the gauge
          let gaugeOptions = {
            hasNeedle: true,
            needleColor: 'gray',
            needleUpdateSpeed: 1000,
            arcColors: ['#e91e63'],
            arcDelimiters: [30],
            rangeLabel: ['0', '100'],
            centralLabel: '50',
          }
          
          // Drawing and updating the chart
          GaugeChart.gaugeChart(element, 200, gaugeOptions).updateNeedle(50)
          </script>
          
          </div>
                          </div><!--//app-card-body-->
                          <a class="app-card-link-mask" href="#"></a>
                        </div><!--//app-card-->
                      </div><!--//col-->
                      
                      <div class="col-12 col-sm-3 col-md-4 mb-4">
                        <div class="app-card app-card-stat shadow-sm h-70">
                          <div class="app-card-body p-3 p-lg-4">
                            <h4 class="stats-type mb-1">Expenses</h4>
                            <div class="stats-figure py-4">$2,250</div>
                          </div><!--//app-card-body-->
                          <a class="app-card-link-mask" href="#"></a>
                        </div><!--//app-card-->
                      </div><!--//col-->
                      <div class="col-12 col-sm-3 col-md-4 mb-4">
                        <div class="app-card app-card-stat shadow-sm h-100">
                          <div class="app-card-body p-3 p-lg-4">
                            <h4 class="stats-type">Projects</h4>
                          </div><!--//app-card-body-->
                                      <div class="chart-container">
                          <canvas style="max-height:80px" id="myChart1"></canvas>
                          <script>
           const data2 = {
                labels: ['Music', 'Sports'],
                datasets: [{
                  label: 'Weekly Sales',
                  data: [3,3],
                  backgroundColor: [
                    'rgba(255, 26, 104, 0.2)',
                    'rgba(255, 159, 64, 0.2)'
                  ],
                  borderColor: [
                    'rgba(255, 26, 104, 1)',
                    'rgba(255, 159, 64, 1)'
                  ],
                  borderWidth: 1
                }]
              };
          
              // config
              const config2 = {
                type: 'doughnut',
                data:data2,
              options: {
              plugins:{
                 legend:{
                  position:'right',
                 }
              }
          }
          
                  };
          
              // render init block
              const myChart1 = new Chart(
                document.getElementById('myChart1'),
                config2
              );
          
               function clickHandler(click) {
                  const points = myChart.getElementsAtEventForMode(click,'nearest',{
                      intersect:true},true);
                  if (points.length) {
                      console.log(points.length)
                      console.log(points[0].element.$context.raw.sales);
          
                  myChart1.config.data.datasets[0].data = points[0].element.$context.raw.sales;
                  myChart1.update();
                }
              }
              ctx.onclick = clickHandler
          
                            </script>
                        </div>
                        </div><!--//app-card-->
                      </div><!--//col-->
                    </div><!--//row-->
                        
                        <div class="col-12">
                          <div class="app-card app-card-stats-table h-50 shadow-sm">
                            <div class="app-card-header p-3">
                              <div class="row justify-content-between align-items-center">
                                <div class="col-auto">
                                      <h4 class="app-card-title">Stats List</h4>
                                </div><!--//col-->
                                <div class="col-auto">
                                  <div class="card-header-action">
                                    <a href="#">View report</a>
                                  </div><!--//card-header-actions-->
                                </div><!--//col-->
                              </div><!--//row-->
                            </div><!--//app-card-header-->
                            <div class="app-card-body p-3 p-lg-4">
                              <div class="table-responsive">
                                <table class="table table-borderless mb-0">
                              <thead>
                                <tr>
                                  <th class="meta">Ticket Name</th>
                                  <th class="meta stat-cell">Quantity</th>
                                  <th class="meta stat-cell">Date</th>
                                  <th class="meta stat-cell">Price</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr>
                                  <td><a href="#">google.com</a></td>
                                  <td class="stat-cell">110</td>
                                  <td class="stat-cell">30%</td>
                                  <td class="stat-cell">$300</td>
                                </tr>
                                <tr>
                                  <td><a href="#">getbootstrap.com</a></td>
                                  <td class="stat-cell">67</td>
                                  <td class="stat-cell">23%</td>
                                  <td class="stat-cell">$200</td>
                                </tr>
                                <tr>
                                  <td><a href="#">w3schools.com</a></td>
                                  <td class="stat-cell">56</td>
                                  <td class="stat-cell">20%</td>
                                  <td class="stat-cell">$200</td>
                                </tr>
                                <tr>
                                  <td><a href="#">javascript.com </a></td>
                                  <td class="stat-cell">24</td>
                                  <td class="stat-cell">30</td>
                                  <td class="stat-cell">$200</td>
                                </tr>
                                <tr>
                                  <td><a href="#">github.com </a></td>
                                  <td class="stat-cell">17</td>
                                  <td class="stat-cell">15%</td>
                                  <td class="stat-cell">$200</td>
                                </tr>
                              </tbody>
                            </table>
                              </div><!--//table-responsive-->
                            </div><!--//app-card-body-->
                          </div><!--//app-card-->
                        </div><!--//col-->
                    
                  </div><!--//container-fluid-->
                </div><!--//app-content-->
          </div>
        </div>


    </div>
</div>
</div>
{% endblock %}